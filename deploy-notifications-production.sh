#!/bin/bash
# Script de dÃ©ploiement des notifications push en production

echo "ğŸš€ DÃ©ploiement Notifications Push - Production"
echo "=============================================="
echo ""

# ClÃ©s VAPID
VAPID_PUBLIC="BKUW6rJDpbTGTbPZY6y0ldcjf3OwpzqOeLIh8DQyZ49EUkYnjHuWKRxoLhHRLyG6vM-aCKuNq2fArvZasobHU6I"
VAPID_PRIVATE="BpNAPhsFbOHMvGjcTI3-6om-jmYpx8bjD0PUwa152sk"
VAPID_EMAIL="mailto:contact@gjsdecrpt.fr"

echo "ğŸ“‹ Ã‰TAPE 1/3 - Configuration Render (Backend)"
echo "---------------------------------------------"
echo ""
echo "ğŸ”— Ouvrez: https://dashboard.render.com"
echo ""
echo "1. SÃ©lectionnez votre service backend 'gj-camp-backend'"
echo "2. Allez dans 'Environment'"
echo "3. Cliquez sur 'Add Environment Variable'"
echo "4. Ajoutez ces 3 variables:"
echo ""
echo "   Nom: VAPID_PUBLIC_KEY"
echo "   Valeur: $VAPID_PUBLIC"
echo ""
echo "   Nom: VAPID_PRIVATE_KEY"
echo "   Valeur: $VAPID_PRIVATE"
echo ""
echo "   Nom: VAPID_EMAIL"
echo "   Valeur: $VAPID_EMAIL"
echo ""
echo "5. Cliquez 'Save Changes'"
echo "6. Le service va redÃ©marrer automatiquement"
echo ""
read -p "âœ… Appuyez sur ENTRÃ‰E quand c'est fait..."
echo ""

echo "ğŸ“‹ Ã‰TAPE 2/3 - Configuration Vercel (Frontend)"
echo "----------------------------------------------"
echo ""
echo "ğŸ”— Ouvrez: https://vercel.com/dashboard"
echo ""
echo "1. SÃ©lectionnez votre projet 'gj-camp-website'"
echo "2. Allez dans 'Settings' â†’ 'Environment Variables'"
echo "3. Cliquez sur 'Add'"
echo "4. Ajoutez cette variable:"
echo ""
echo "   Nom: REACT_APP_VAPID_PUBLIC_KEY"
echo "   Valeur: $VAPID_PUBLIC"
echo "   Environments: Production, Preview, Development (cochez toutes)"
echo ""
echo "5. Cliquez 'Save'"
echo ""
read -p "âœ… Appuyez sur ENTRÃ‰E quand c'est fait..."
echo ""

echo "ğŸ“‹ Ã‰TAPE 3/3 - RedÃ©ploiement"
echo "----------------------------"
echo ""
echo "ğŸ”„ Vercel va redÃ©ployer automatiquement"
echo "ğŸ”„ Render a dÃ©jÃ  redÃ©marrÃ©"
echo ""
echo "Attendez 2-3 minutes puis testez:"
echo ""
echo "ğŸ§ª Test Backend:"
echo "   curl https://gj-camp-backend.onrender.com/api/health"
echo "   (Devrait rÃ©pondre avec succÃ¨s)"
echo ""
echo "ğŸ§ª Test Frontend:"
echo "   1. Allez sur https://gjsdecrpt.fr/profile"
echo "   2. Connectez-vous"
echo "   3. Section 'Notifications Push'"
echo "   4. Activez le toggle"
echo "   5. Autoriser les permissions du navigateur"
echo "   6. Une notification de test devrait apparaÃ®tre"
echo ""
read -p "âœ… Appuyez sur ENTRÃ‰E pour terminer..."
echo ""

echo "âœ… Configuration terminÃ©e !"
echo ""
echo "ğŸ“ Pour vÃ©rifier les logs:"
echo "   - Render: https://dashboard.render.com â†’ Logs"
echo "   - Vercel: https://vercel.com â†’ Deployments"
echo ""
echo "ğŸ› En cas de problÃ¨me, consultez: NOTIFICATIONS_PUSH_CONFIG.md"
